{% extends 'base.html' %}

{% load static %}

{% block title %}Gerenciar pacientes{% endblock %}

{% block content %}

<link rel="stylesheet" href="{% static 'css/style_gerenciar_pacientes.css' %}">
<header>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">
        <img src="{% static 'images/portal_do_paciente_icon.png' %}" alt="home" width="30" height="30">
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">  
          <li class="nav-item">
            <a class="nav-link" href="{% url 'portal_do_paciente' id=paciente.id%}">Voltar </a>
            <a class="nav-link" href="{% url 'cadastro_de_medicos' id=paciente.id%}">Cadastre um novo medico </a>
            <a class="nav-link" href=#>Guia rápido</a>
          </li>
        </ul>
        
      </div>
    </div>
  </nav>
</header>

<h1 style="text-align: center;">Gerenciamento</h1>
<br>

<div class="container-fluid">
    <table class="table table-striped">
        <thead>
          <tr>
            <th>Id</th>
            <th>Nome</th>
            <th>CPF</th>
            <th>Email</th>
          </tr>
        </thead>
        <tbody>
            {% for paciente in pacientes %}
            <tr>
                {% if paciente.nome%} 
                    <td>{{ paciente.id }}</td>
                    <td>{{ paciente.nome }}</td> 
                    <td>{{ paciente.cpf }}</td> 
                    <td>{{ paciente.email }}</td>
                {% endif %}
            </tr>
            {% endfor %}
        </tbody>
      </table>
    
</div>


<div class="container mt-5" >
  <div id="div-title-cadatro">
      <h2>Cadastre um novo paciente</h2>
  </div>
  
  <div class="row justify-content-center">  <!-- Centraliza o formulário -->
      <div class="col-md-6" id="div-form-cadastro">  <!-- Define a largura máxima do formulário em telas médias -->
          <form method="POST" class="form-group">
              {% csrf_token %}
              {% for field in form %}
                  <div class="form-group">
                      <label for="{{ field.id_for_label }}" class="form-label">{{ field.label }}</label>
                      {{ field }}
                      {% if field.errors %}
                          <ul class="errors">
                              {% for error in field.errors %}
                                  <li class="text-danger">{{ error }}</li>
                              {% endfor %}
                          </ul>
                      {% endif %}
                  </div>
              {% endfor %}
              <button type="submit" class="btn btn-primary">Cadastrar</button>
          </form>
          <br>
          <br>

          <br>
                      </div>
  </div>
  <script>
    function formatarCPF(cpf) {
// Remove caracteres não numéricos
cpf = cpf.replace(/[^0-9]/g, '');

// Verifica se o CPF tem 11 dígitos
if (cpf.length !== 11) {
return cpf; // Retorna o CPF sem formatação se não tiver 11 dígitos
}

// Formata o CPF: xxx.xxx.xxx-xx
return cpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
}

// Exemplo de uso:
const inputCPF =document.querySelector("#id_cpf");

inputCPF.addEventListener('input', function() {
this.value = formatarCPF(this.value);
});
  </script>
</div>



{% endblock %}